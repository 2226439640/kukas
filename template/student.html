<!DOCTYPE html>
<!-- saved from url=(0060)http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8" />
    <meta name="author" content="order by dede58.com">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/img/logo.png">
    <title>测试用例管理系统</title>
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/mmss.css">
    <link rel="stylesheet" href="/static/css/font-awesome.min.css">
    <script src="/static/js/jquery-1.11.3.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <style>

    </style>
</head>
<body>
<header>
    <div class="container-fluid navbar-fixed-top bg-primary">
        <ul class="nav navbar-nav  left">
            <li class="text-white h4">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-leaf"></span>&nbsp;&nbsp;<b>测试用例管理系统</b>
            </li>
        </ul>
        <ul class="nav navbar-nav nav-pills right ">
            <li class="bg-info dropdown">
                <a class="dropdown-toggle" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#" data-toggle="dropdown">
                    <span class="glyphicon glyphicon-user"></span>&nbsp;<span>系统管理员</span><span class="caret"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                    <li class="text-center"><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><span class="text-primary">账号设置</span></a></li>
                    <li class="divider"><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"></a></li>
                    <li class="text-center"><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/login.html"><span class="text-primary">退出</span></a></li>
                </ul>
            </li>
        </ul>
    </div>
</header>

<section>
    <div class="container-fluid">
        <div class="row ">
            <!--左侧导航开始-->
            <div class="col-xs-2 bg-blue">
                <br>
                <div class="panel-group sidebar-menu" id="accordion" aria-multiselectable="true">
                    <div class="panel panel-default menu-first menu-first-active">
                        <a data-toggle="collapse" data-parent="#accordion" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/index.html" aria-expanded="true" aria-controls="collapseOne">
                            <i class="icon-home icon-large"></i> 主页
                        </a>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a data-toggle="collapse" data-parent="#accordion" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            <i class="icon-user-md icon-large"></i> 用例管理</a>
                        

                        <div id="collapseOne" class="panel-collapse collapse in">
                            <ul class="nav nav-list menu-second">
                                <li><a href="http://127.0.0.1:8000/case/students/1/"><i class="icon-user"></i> 学生端</a></li>
                                <li><a href="http://127.0.0.1:8000/case/teachers/1/"><i class="icon-edit"></i> 教师端</a></li>
                                <li><a href="http://127.0.0.1:8000/case/princpals/1/"><i class="icon-trash"></i> 校区运营</a></li>
                                <li><a href="http://127.0.0.1:8000/case/questions/1/"><i class="icon-list"></i> 题库</a></li>
                                <li><a href="http://127.0.0.1:8000/case/learns/1/"><i class="icon-list"></i> 学习系统</a></li>
                                <li><a href="http://127.0.0.1:8000/case/others/1/"><i class="icon-list"></i> 其他</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            <i class="icon-book icon-large"></i> 用户管理</a>
                        
                        <div id="collapseTwo" class="panel-collapse collapse">
                            <ul class="nav nav-list menu-second">
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-user"></i> 子选项1</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-edit"></i> 子选项2</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-trash"></i> 子选项3</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-list"></i> 子选项4</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            <i class="icon-book icon-large"></i> 其他管理</a>


                        <div id="collapseThree" class="panel-collapse collapse">
                            <ul class="nav nav-list menu-second">
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-user"></i> 子选项1</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-edit"></i> 子选项2</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-trash"></i> 子选项3</a></li>
                                <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#"><i class="icon-list"></i> 子选项4</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!--左侧导航结束-->
            <!----------------------------------------------------------------------------------------------------->
            <!--右侧内容开始-->
            <div class="col-xs-10">
                <br>
                <ol class="breadcrumb">
                    <li><a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/index.html"><span class="glyphicon glyphicon-home"></span>&nbsp;后台首页</a></li>
                    <li class="active">系统管理 - 表格</li>
                </ol>
                <div class="input-group line left">
                    <span class="input-group-addon" id="basic-addon2"><span class="glyphicon glyphicon-search"></span></span>
                    <input type="text" class="form-control" id="searchcase" placeholder="标签或用例名称" aria-describedby="basic-addon2">
                </div>
                <select class="form-control line left" id="taglevel">
                    <option></option>
                    <option>高</option>
                    <option>中</option>
                    <option>低</option>
                </select>
                <a class=" btn btn-primary" onclick="getAjax4()"><span class="glyphicon glyphicon-search"></span></a>
                <a href="http://demo.kangjingept.com:8020/cssthemes6/1.18ZF07/p1.html#" class=" btn btn-primary "><span class="glyphicon glyphicon-download"></span></a>
                <br><br>
                <div class="modal fade" id="add1" tabindex="-1" role="dialog" aria-labelledby="add11">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                        <h4 class="modal-title" id="myModalLabel">添加</h4>
                                    </div>
                                    <div class="modal-body">
                                        <ul>
{#                                            <li>#}
{#                                                <label><span>序号 </span></label>#}
{#                                                <input type="text" class="id" disabled="disabled" >#}
{#                                            </li>#}
                                            <li>
                                                <label><span>用例名称 </span></label>
                                                <input type="text" class="name1">
                                            </li>
                                            <li>
                                                <label><span>前置条件 </span></label>
                                                <input type="text" class="precondition1">
                                            </li>
                                            <li>
                                                <label><span>步骤 </span></label>
                                                <input type="text" class="processing1">
                                            </li>
                                            <li>
                                                <label><span>预期结果 </span></label>
                                                <input type="text" class="result1">
                                            </li>
                                            <li>
                                                <label><span>需求id </span></label>
                                                <input type="text" class="id21">
                                            </li>
                                            <li>
                                                <label><span>标签 </span></label>
                                                <input type="text" class="tag1">
                                            </li>
                                            <li>
                                                <label><span>等级 </span></label>
                                                <input type="text" class="level1">
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">取消</button>
                                        <button type="button" class="btn btn-primary btn-sm" onclick="getAjax2()">保存</button>
                                    </div>
                                </div>
                            </div>
                        </div><div class="modal fade" id="edit" tabindex="-1" role="dialog" aria-labelledby="edit">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="edit" aria-label="Close"><span aria-hidden="true">×</span></button>
                                        <h4 class="modal-title" id="myModalLabel1">编辑</h4>
                                    </div>
                                    <div class="modal-body">
                                        <ul>
                                            <li>
                                                <label><span>序号 </span></label>
                                                <input type="text" class="id" disabled="disabled">
                                            </li>
                                            <li>
                                                <label><span>用例名称 </span></label>
                                                <input type="text" class="name">
                                            </li>
                                            <li>
                                                <label><span>前置条件 </span></label>
                                                <input type="text" class="precondition">
                                            </li>
                                            <li>
                                                <label><span>步骤 </span></label>
                                                <input type="text" class="processing">
                                            </li>
                                            <li>
                                                <label><span>预期结果 </span></label>
                                                <input type="text" class="result">
                                            </li>
                                            <li>
                                                <label><span>需求id </span></label>
                                                <input type="text" class="id2">
                                            </li>
                                            <li>
                                                <label><span>标签 </span></label>
                                                <input type="text" class="tag">
                                            </li>
                                            <li>
                                                <label><span>等级 </span></label>
                                                <input type="text" class="level">
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">取消</button>
                                        <button type="button" class="btn btn-primary btn-sm" onclick="getAjax()">保存</button>
                                    </div>
                                </div>
                            </div>
                        </div><table class="table table-bordered table-striped text-center bg-info" id="mytable">
                    <thead>
                    <tr class="info">
                        <th class="text-center">序号</th>
                        <th class="text-center">用例名称</th>
                        <th class="text-center">前置条件</th>
                        <th class="text-center">步骤</th>
                        <th class="text-center">预期结果</th>
                        <th class="text-center">需求id</th>
                        <th class="text-center">标签</th>
                        <th class="text-center">等级</th>
                        <th class="text-center">最后更新时间</th>
                        <th class="text-center">创建人</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for student in students %}
                        <tr>
                            <td>{{student.pk}}</td>
                            {% for s in student.fields.values %}
                                {% if forloop.counter == 9%}
                                <td>{{s|date:"Y-m-d H:i:s"}}</td>
                                {% else%}
                                    <td>{{s}}</td>
                                {% endif %}
                            {% endfor %}
                        <td>
                            <a class="btn btn-primary btn-sm" data-toggle="modal" data-target="#add1" >添加</a>
                            <a class="btn btn-primary btn-sm" onclick="showDialog(this)">编辑</a>
                            <a class="btn btn-primary btn-sm" onclick="getid(this), getAjax3()">删除</a>
                        </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <ul class="pagination right" id="myul">
                    <li><a href="http://127.0.0.1:8000/case/students/{{ pageNow|add:-1 }}/" aria-label="Previous"><span aria-hidden="true">«</span></a>
                    </li>
                    {% for page in pageNums %}
                        {% if pageNow == page %}
                            <li class="active"><a href="http://127.0.0.1:8000/case/students/{{ page }}/">{{page}}<span class="sr-only">(current)</span></a></li>
                        {% else %}
                            <li><a href="http://127.0.0.1:8000/case/students/{{ page }}/">{{ page }}</a></li>
                        {% endif %}
                    {% endfor %}
                    <li><a href="http://127.0.0.1:8000/case/students/{{ pageNow|add:1 }}/" aria-label="Next"><span aria-hidden="true">»</span></a></li>
                </ul>
            </div>
            <!--右侧内容结束-->
        </div>
    </div>
</section>

<footer class="bg-primary navbar-fixed-bottom">
    <p class="text-center text-white">版权所有©lxp</p>
</footer>

<script>
    function showDialog(obj){
	//点击更新按钮后展示模态框

	 //获取当前行的所有列
	 var tds= $(obj).parent().parent().find('td');
	 //(".id"):通过class属性获取当前需要填写数据的输入框
	 //$(tds.eq(0)).text():通过下标取得对应列中的值
	 $(".id").val($(tds.eq(0)).text());
	 $(".name").val($(tds.eq(1)).text());
	 $(".precondition").val($(tds.eq(2)).text());
	 $(".processing").val($(tds.eq(3)).text());
	 $(".result").val($(tds.eq(4)).text());
	 $(".id2").val($(tds.eq(5)).text());
	 $(".tag").val($(tds.eq(6)).text());
	 $(".level").val($(tds.eq(7)).text());
	 $('#edit').modal('show');
	 {#$('#add1').modal('show');#}

}

function getid(obj) {
   var tds= $(obj).parent().parent().find('td');
	 //(".id"):通过class属性获取当前需要填写数据的输入框
	 //$(tds.eq(0)).text():通过下标取得对应列中的值
	 $(".id").val($(tds.eq(0)).text());
}

function getAjax() {
       $.ajax({
                   url: '/case/updatecase/',
                   type: 'post',
                   contentType: "application/json",
                   dataType:"json",
                   data: JSON.stringify({"caseid": $(".id").val(),
                          "caseName": $(".name").val(),
                          "casePre": $(".precondition").val(),
                          "caseStep": $(".processing").val(),
                          "caseResult": $(".result").val(),
                          "needid": $(".id2").val(),
                          "tag": $(".tag").val(),
                          "grade": $(".level").val()
                   }),
                });
                $("#edit").modal('hide');
       };


function getAjax2() {
       $.ajax({
                   url: '/case/uploadcase/',
                   type: 'post',
                   contentType: "application/json",
                   dataType:"json",
                   data: JSON.stringify({
                          "caseName": $(".name1").val(),
                          "casePre": $(".precondition1").val(),
                          "caseStep": $(".processing1").val(),
                          "caseResult": $(".result1").val(),
                          "needid": $(".id21").val(),
                          "tag": $(".tag1").val(),
                          "grade": $(".level1").val()
                   }),
                });
       $("#add1").modal('hide');
       };

function getAjax3() {

       $.ajax({
                   url: '/case/delcase/',
                   type: 'post',
                   contentType: "application/json",
                   dataType:"json",
                   data: JSON.stringify({
                          "caseid":$(".id").val()
                   }),

                });

       };

String.prototype.format = function(args) {
  if (arguments.length > 0) {
    var result = this;
    if (arguments.length == 1 && typeof(args) == "object") {
      for (var key in args) {
        var reg = new RegExp("({" + key + "})", "g");
        result = result.replace(reg, args[key]);
      }
    } else {
      for (var i = 0; i < arguments.length; i++) {
        if (arguments[i] == undefined) {
          return "";
        } else {
          var reg = new RegExp("({[" + i + "]})", "g");
          result = result.replace(reg, arguments[i]);
        }
      }
    }
    return result;
  } else {
    return this;
  }
}

function getAjax4(page=1) {
       if($("#searchcase").val() == "" && $("#taglevel").val() == "")
       {
           alert("搜索条件为空！");
           window.location.reload();
       }
       $.ajax({
                   url: '/case/search/{0}/'.format(page),
                   type: 'post',
                   contentType: "application/json",
                   data: JSON.stringify({
                          "searchcase":$("#searchcase").val(),
                          "taglevel":$("#taglevel").val(),
                   }),
                   success: function(data){
                       var table = document.getElementById("mytable");
                       var table_length = table.rows.length
                       for(var i=1;i<table_length;++i)
                       {
                            table.deleteRow(1);
                       }
                       case_data = data["result"]
                       for(var i=0;i<case_data.length;++i){
                           table.insertRow(i+1)
                           for(var j=0;j<case_data[i].length;++j)
                           {
                               text = document.createTextNode(case_data[i][j]);
                               td = table.rows[i+1].insertCell(j)
                               td.appendChild(text)
                           }
                           td = table.rows[i+1].insertCell(case_data[i].length)
                           td.innerHTML = "<a class='btn btn-primary btn-sm' data-toggle='modal' data-target='#add1' >添加</a><a class='btn btn-primary btn-sm' onclick='showDialog(this)'>编辑</a><a class='btn btn-primary btn-sm' onclick='getid(this), getAjax3()'>删除</a>";
                       }
                       var myul = document.getElementById('myul');
                       $("#myul").html('');
                       var li=document.createElement("li");
                       li.innerHTML="<a aria-label='Previous' onclick='getAjax4({0})'><span aria-hidden='true'>«</span></a>".format(data["pageNow"]-1)
                       myul.appendChild(li)
                       for(var i=1;i<=data["pageNums"];++i)
                       {
                           li=document.createElement("li");
                           li.innerHTML = "<a onclick='getAjax4({0})'>{0}</a></li>".format(i)
                           if(i == data["pageNow"])
                           {
                               li.className = "active";
                           }
                           myul.appendChild(li)
                       }
                       li=document.createElement("li");
                       li.innerHTML="<a aria-label='Next' onclick='getAjax4({0})'><span aria-hidden='true'>»</span></a></li>".format(data["pageNow"]+1)
                       myul.appendChild(li)
                   },
                });
            return true;
       };
</script>


</body></html>